<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Code Examples &mdash; snptools version 1.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=5c1c9e08"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="snptools" href="modules.html" />
    <link rel="prev" title="Introduction" href="description.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            snptools
              <img src="_static/logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="description.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="description.html#installation">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="description.html#usage">Usage</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Code Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#head-file-finalreport">Head file FinalReport</a></li>
<li class="toctree-l2"><a class="reference internal" href="#processing-the-finalreport-txt">Processing the Finalreport.txt</a></li>
<li class="toctree-l2"><a class="reference internal" href="#preparation-snp-files">Preparation SNP files</a></li>
<li class="toctree-l2"><a class="reference internal" href="#data-formatting">Data formatting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#blupf90-format">blupf90 format</a></li>
<li class="toctree-l3"><a class="reference internal" href="#plink-format">plink format</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#data-filtering">Data filtering</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#call-rate">Call Rate</a></li>
<li class="toctree-l3"><a class="reference internal" href="#frequence-allele">Frequence Allele</a></li>
<li class="toctree-l3"><a class="reference internal" href="#hwe-hardy-weinberg-equilibrium">HWE (Hardy-Weinberg equilibrium)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#parentage">Parentage</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="modules.html">snptools</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">snptools</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Code Examples</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/examples.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="code-examples">
<h1>Code Examples<a class="headerlink" href="#code-examples" title="Link to this heading"></a></h1>
<section id="head-file-finalreport">
<h2>Head file FinalReport<a class="headerlink" href="#head-file-finalreport" title="Link to this heading"></a></h2>
<p>adfafrfa rfer f:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">Header</span><span class="p">]</span>
<span class="n">GSGT</span> <span class="n">Version</span>        <span class="mf">2.0.4</span>
<span class="n">Processing</span> <span class="n">Date</span>     <span class="mi">1</span><span class="o">/</span><span class="mi">16</span><span class="o">/</span><span class="mi">2023</span> <span class="mi">9</span><span class="p">:</span><span class="mi">19</span> <span class="n">AM</span>
<span class="n">Content</span>             <span class="n">GGP_HDv3_C</span><span class="o">.</span><span class="n">bpm</span>
<span class="n">Num</span> <span class="n">SNPs</span>    <span class="mi">139376</span>
<span class="n">Total</span> <span class="n">SNPs</span>  <span class="mi">140668</span>
<span class="n">Num</span> <span class="n">Samples</span> <span class="mi">25</span>
<span class="n">Total</span> <span class="n">Samples</span>       <span class="mi">26</span>
<span class="n">File</span>        <span class="mi">1</span> <span class="n">of</span> <span class="mi">25</span>
<span class="p">[</span><span class="n">Data</span><span class="p">]</span>
<span class="n">SNP</span> <span class="n">Name</span>    <span class="n">Sample</span> <span class="n">ID</span>       <span class="n">Allele1</span> <span class="o">-</span> <span class="n">Forward</span>       <span class="n">Allele2</span> <span class="o">-</span> <span class="n">Forward</span>       <span class="n">Allele1</span> <span class="o">-</span> <span class="n">Top</span>   <span class="n">Allele2</span> <span class="o">-</span> <span class="n">Top</span>   <span class="n">Allele1</span> <span class="o">-</span> <span class="n">AB</span>    <span class="n">Allele2</span> <span class="o">-</span> <span class="n">AB</span>    <span class="n">GC</span> <span class="n">Score</span>        <span class="n">X</span>       <span class="n">Y</span>
<span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">10172</span>  <span class="n">HO840M003135245650</span>      <span class="n">G</span>       <span class="n">G</span>       <span class="n">G</span>       <span class="n">G</span>       <span class="n">B</span>       <span class="n">B</span>       <span class="mf">0.9420</span>  <span class="mf">0.069</span>   <span class="mf">0.801</span>
<span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">1020</span>   <span class="n">HO840M003135245650</span>      <span class="n">G</span>       <span class="n">G</span>       <span class="n">G</span>       <span class="n">G</span>       <span class="n">B</span>       <span class="n">B</span>       <span class="mf">0.9489</span>  <span class="mf">0.033</span>   <span class="mf">0.700</span>
<span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">10245</span>  <span class="n">HO840M003135245650</span>      <span class="n">C</span>       <span class="n">C</span>       <span class="n">G</span>       <span class="n">G</span>       <span class="n">B</span>       <span class="n">B</span>       <span class="mf">0.7277</span>  <span class="mf">0.152</span>   <span class="mf">1.504</span>
<span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">10345</span>  <span class="n">HO840M003135245650</span>      <span class="n">A</span>       <span class="n">C</span>       <span class="n">A</span>       <span class="n">C</span>       <span class="n">A</span>       <span class="n">B</span>       <span class="mf">0.9411</span>  <span class="mf">0.598</span>   <span class="mf">0.572</span>
<span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">10375</span>  <span class="n">HO840M003135245650</span>      <span class="n">A</span>       <span class="n">G</span>       <span class="n">A</span>       <span class="n">G</span>       <span class="n">A</span>       <span class="n">B</span>       <span class="mf">0.9348</span>  <span class="mf">0.430</span>   <span class="mf">0.494</span>
<span class="o">...</span>
</pre></div>
</div>
</section>
<section id="processing-the-finalreport-txt">
<h2>Processing the Finalreport.txt<a class="headerlink" href="#processing-the-finalreport-txt" title="Link to this heading"></a></h2>
<p>Override the right click popup menu</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">snptools.finalreport</span> <span class="kn">import</span> <span class="n">FinalReport</span>

<span class="n">obj_report</span> <span class="o">=</span> <span class="n">FinalReport</span><span class="p">()</span>
<span class="n">obj_report</span><span class="o">.</span><span class="n">handle</span><span class="p">(</span><span class="s2">&quot;path/to/finalreport.txt&quot;</span><span class="p">)</span>

<span class="n">header</span> <span class="o">=</span> <span class="n">obj_report</span><span class="o">.</span><span class="n">header</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">obj_report</span><span class="o">.</span><span class="n">snp_data</span>
</pre></div>
</div>
<p>Output pd.Dataframe:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;SNP Name&quot;</span> <span class="s2">&quot;Sample ID&quot;</span> <span class="s2">&quot;Allele1 - Forward&quot;</span> <span class="s2">&quot;Allele2 - Forward&quot;</span> <span class="s2">&quot;Allele1 - Top&quot;</span> <span class="s2">&quot;Allele2 - Top&quot;</span> <span class="s2">&quot;Allele1 - AB&quot;</span> <span class="s2">&quot;Allele2 - AB&quot;</span> <span class="s2">&quot;GC Score&quot;</span> <span class="n">X</span> <span class="n">Y</span>
<span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">10172</span> <span class="n">HO840M003135245650</span> <span class="n">G</span> <span class="n">G</span> <span class="n">G</span> <span class="n">G</span> <span class="n">B</span> <span class="n">B</span> <span class="mf">0.9420</span> <span class="mf">0.069</span> <span class="mf">0.801</span>
<span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">1020</span> <span class="n">HO840M003135245650</span> <span class="n">G</span> <span class="n">G</span> <span class="n">G</span> <span class="n">G</span> <span class="n">B</span> <span class="n">B</span> <span class="mf">0.9489</span> <span class="mf">0.033</span> <span class="mf">0.700</span>
<span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">10245</span> <span class="n">HO840M003135245650</span> <span class="n">C</span> <span class="n">C</span> <span class="n">G</span> <span class="n">G</span> <span class="n">B</span> <span class="n">B</span> <span class="mf">0.7277</span> <span class="mf">0.152</span> <span class="mf">1.504</span>
<span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">10345</span> <span class="n">HO840M003135245650</span> <span class="n">A</span> <span class="n">C</span> <span class="n">A</span> <span class="n">C</span> <span class="n">A</span> <span class="n">B</span> <span class="mf">0.9411</span> <span class="mf">0.598</span> <span class="mf">0.572</span>
<span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">10375</span> <span class="n">HO840M003135245650</span> <span class="n">A</span> <span class="n">G</span> <span class="n">A</span> <span class="n">G</span> <span class="n">A</span> <span class="n">B</span> <span class="mf">0.9348</span> <span class="mf">0.430</span> <span class="mf">0.494</span>
</pre></div>
</div>
<p>Select alleles - AB or Top or Forward</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">alleles_ab</span> <span class="o">=</span> <span class="n">FinalReport</span><span class="p">(</span><span class="n">allele</span><span class="o">=</span><span class="s2">&quot;AB&quot;</span><span class="p">)</span>
<span class="n">alleles_ab</span><span class="o">.</span><span class="n">handle</span><span class="p">(</span><span class="s2">&quot;path/to/finalreport.txt&quot;</span><span class="p">)</span>
<span class="n">data_ab</span> <span class="o">=</span> <span class="n">alleles_ab</span><span class="o">.</span><span class="n">snp_data</span>

<span class="n">alleles_top</span> <span class="o">=</span> <span class="n">FinalReport</span><span class="p">(</span><span class="n">allele</span><span class="o">=</span><span class="s2">&quot;Top&quot;</span><span class="p">)</span>
<span class="n">alleles_top</span><span class="o">.</span><span class="n">handle</span><span class="p">(</span><span class="s2">&quot;path/to/finalreport.txt&quot;</span><span class="p">)</span>
<span class="n">data_top</span> <span class="o">=</span> <span class="n">alleles_top</span><span class="o">.</span><span class="n">snp_data</span>

<span class="n">alleles_forward</span> <span class="o">=</span> <span class="n">FinalReport</span><span class="p">(</span><span class="n">allele</span><span class="o">=</span><span class="s2">&quot;Forward&quot;</span><span class="p">)</span>
<span class="n">alleles_forward</span><span class="o">.</span><span class="n">handle</span><span class="p">(</span><span class="s2">&quot;path/to/finalreport.txt&quot;</span><span class="p">)</span>
<span class="n">data_forward</span> <span class="o">=</span> <span class="n">alleles_forward</span><span class="o">.</span><span class="n">snp_data</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;SNP Name&quot;</span> <span class="s2">&quot;Sample ID&quot;</span> <span class="s2">&quot;Allele1 - AB&quot;</span> <span class="s2">&quot;Allele2 - AB&quot;</span> <span class="s2">&quot;GC Score&quot;</span> <span class="n">X</span> <span class="n">Y</span>
<span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">10172</span> <span class="n">HO840M003135245650</span> <span class="n">B</span> <span class="n">B</span> <span class="mf">0.9420</span> <span class="mf">0.069</span> <span class="mf">0.801</span>
<span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">1020</span> <span class="n">HO840M003135245650</span> <span class="n">B</span> <span class="n">B</span> <span class="mf">0.9489</span> <span class="mf">0.033</span> <span class="mf">0.700</span>
<span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">10245</span> <span class="n">HO840M003135245650</span> <span class="n">B</span> <span class="n">B</span> <span class="mf">0.7277</span> <span class="mf">0.152</span> <span class="mf">1.504</span>
<span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">10345</span> <span class="n">HO840M003135245650</span> <span class="n">A</span> <span class="n">B</span> <span class="mf">0.9411</span> <span class="mf">0.598</span> <span class="mf">0.572</span>
<span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">10375</span> <span class="n">HO840M003135245650</span> <span class="n">A</span> <span class="n">B</span> <span class="mf">0.9348</span> <span class="mf">0.430</span> <span class="mf">0.494</span><span class="n">f</span>

<span class="o">...</span>
</pre></div>
</div>
</section>
<section id="preparation-snp-files">
<h2>Preparation SNP files<a class="headerlink" href="#preparation-snp-files" title="Link to this heading"></a></h2>
<p>After processing the raw data, FinalReports.txt, for further analysis
several steps of SNP (Single Nucleotide Polymorphism) file preparation are
necessary.</p>
</section>
<section id="data-formatting">
<h2>Data formatting<a class="headerlink" href="#data-formatting" title="Link to this heading"></a></h2>
<p>The received data often requires formatting to bring it to a standardized form.
The proposed module includes data formatting for the programs blupf90 and
plink - GBLUP, ssGBLUP, GWAS.</p>
<section id="blupf90-format">
<h3>blupf90 format<a class="headerlink" href="#blupf90-format" title="Link to this heading"></a></h3>
<p>The input data for obtaining the <code class="docutils literal notranslate"><span class="pre">snp.txt</span></code> file used for the genomic
blupf90 evaluation is the data file - processed file <code class="docutils literal notranslate"><span class="pre">finalreport.txt</span></code></p>
<p><strong>uga</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">snptools.format</span> <span class="kn">import</span> <span class="n">Snp</span>

<span class="n">data_finalreport</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;file.txt&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">obj</span> <span class="o">=</span> <span class="n">Snp</span><span class="p">(</span><span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;uga&quot;</span><span class="p">)</span>
<span class="n">obj_snp</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">data_finalreport</span><span class="p">)</span>
<span class="n">obj_snp</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="s2">&quot;./snp.txt&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Data after snp processing in <code class="docutils literal notranslate"><span class="pre">uga</span></code> (blupf90) format - obj_snp.data:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="n">SAMPLE_ID</span>                <span class="n">SNP</span>
<span class="mi">0</span>     <span class="mi">14814</span>  <span class="mi">02011015010000500</span>
<span class="mi">1</span>     <span class="mi">14815</span>  <span class="mi">01110152120222512</span>
</pre></div>
</div>
<p>Default result:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>                <span class="n">SNP_NAME</span> <span class="n">SAMPLE_ID</span> <span class="n">SNP</span>
<span class="mi">0</span>               <span class="n">ABCA12</span>     <span class="mi">14814</span>   <span class="mi">0</span>
<span class="mi">1</span>   <span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">13031</span>     <span class="mi">14814</span>   <span class="mi">2</span>
<span class="mi">2</span>   <span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">13039</span>     <span class="mi">14814</span>   <span class="mi">0</span>
<span class="mi">3</span>   <span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">13049</span>     <span class="mi">14814</span>   <span class="mi">1</span>
                <span class="o">...</span>
<span class="mi">17</span>              <span class="n">ABCA12</span>     <span class="mi">14815</span>   <span class="mi">0</span>
<span class="mi">18</span>  <span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">13031</span>     <span class="mi">14815</span>   <span class="mi">1</span>
<span class="mi">19</span>  <span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">13039</span>     <span class="mi">14815</span>   <span class="mi">1</span>
<span class="mi">20</span>  <span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">13049</span>     <span class="mi">14815</span>   <span class="mi">1</span>
                <span class="o">...</span>
</pre></div>
</div>
</section>
<section id="plink-format">
<h3>plink format<a class="headerlink" href="#plink-format" title="Link to this heading"></a></h3>
<p>This page describes specialized PLINK input and output file formats which are
identifiable by file extension. <a class="reference external" href="https://www.cog-genomics.org/plink/1.9/formats">https://www.cog-genomics.org/plink/1.9/formats</a>
Распространненные фомраты для проведения GWAS анализа - <code class="docutils literal notranslate"><span class="pre">ped</span></code>, <code class="docutils literal notranslate"><span class="pre">map</span></code>, <code class="docutils literal notranslate"><span class="pre">fam</span></code>, <code class="docutils literal notranslate"><span class="pre">lgen</span></code>…</p>
<p><strong>map</strong> - <a class="reference external" href="https://www.cog-genomics.org/plink/1.9/formats#map">https://www.cog-genomics.org/plink/1.9/formats#map</a></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">snptools.format</span> <span class="kn">import</span> <span class="n">make_map</span>

<span class="n">input_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">DIR_FILES</span> <span class="o">/</span> <span class="s2">&quot;./file_bovinesnp50.csv&quot;</span><span class="p">)</span>
<span class="n">data_map</span> <span class="o">=</span> <span class="n">make_map</span><span class="p">(</span><span class="n">input_data</span><span class="p">)</span>
</pre></div>
</div>
<p>Output data view:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Chr</span>                <span class="n">Name</span>  <span class="n">morgans</span>  <span class="n">MapInfo</span>
 <span class="mi">0</span>  <span class="n">BovineHD0100037694</span>        <span class="mi">0</span>        <span class="mi">0</span>
 <span class="mi">0</span>  <span class="n">BovineHD0100037699</span>        <span class="mi">0</span>        <span class="mi">0</span>
 <span class="mi">0</span>  <span class="n">BovineHD0100037703</span>        <span class="mi">0</span>        <span class="mi">0</span>
 <span class="mi">0</span>  <span class="n">BovineHD0100037704</span>        <span class="mi">0</span>        <span class="mi">0</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>file_bovinesnp50.csv - The file that is taken on the Illumina website with full
information about the chip
<a class="reference external" href="https://support.illumina.com/downloads/bovinesnp50-v3-0-product-files.html">https://support.illumina.com/downloads/bovinesnp50-v3-0-product-files.html</a></p>
</div>
<p><strong>ped</strong> - <a class="reference external" href="https://www.cog-genomics.org/plink/1.9/formats#ped">https://www.cog-genomics.org/plink/1.9/formats#ped</a></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">snptools.format</span> <span class="kn">import</span> <span class="n">make_ped</span>

<span class="n">input_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;file.txt&quot;</span><span class="p">)</span>
<span class="n">data_ped</span> <span class="o">=</span> <span class="n">make_ped</span><span class="p">(</span>
    <span class="n">input_data</span><span class="p">,</span> <span class="s2">&quot;SAMPLE_ID&quot;</span><span class="p">,</span> <span class="s2">&quot;SNP&quot;</span><span class="p">,</span> <span class="n">fid_col</span><span class="o">=</span><span class="s2">&quot;SAMPLE_ID&quot;</span>
<span class="p">)</span>

<span class="ow">or</span>

<span class="n">data_ped</span> <span class="o">=</span> <span class="n">make_ped</span><span class="p">(</span>
    <span class="n">input_data</span><span class="p">,</span>
    <span class="s2">&quot;SAMPLE_ID&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SNP&quot;</span><span class="p">,</span>
    <span class="n">fid_col</span><span class="o">=</span><span class="s2">&quot;FAMILY_ID&quot;</span><span class="p">,</span>
    <span class="n">father_col</span><span class="o">=</span><span class="s2">&quot;father&quot;</span><span class="p">,</span>
    <span class="n">mother_col</span><span class="o">=</span><span class="s2">&quot;mother&quot;</span><span class="p">,</span>
    <span class="n">sex_col</span><span class="o">=</span><span class="s2">&quot;sex&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Input data view:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SAMPLE_ID</span>  <span class="n">SNP</span>
     <span class="mi">1100</span>  <span class="mi">025</span>
     <span class="mi">1101</span>  <span class="mi">022</span>
     <span class="mi">1102</span>  <span class="mi">052</span>
     <span class="mi">1103</span>  <span class="mi">022</span>

 <span class="ow">or</span>

<span class="n">SAMPLE_ID</span>  <span class="n">SNP</span>  <span class="n">FAMILY_ID</span>  <span class="n">father</span>  <span class="n">mother</span>  <span class="n">sex</span>
     <span class="mi">1100</span>  <span class="mi">025</span>       <span class="mi">1100</span>       <span class="mi">1</span>       <span class="mi">5</span>    <span class="mi">1</span>
     <span class="mi">1101</span>  <span class="mi">022</span>       <span class="mi">1101</span>       <span class="mi">2</span>       <span class="mi">6</span>    <span class="mi">2</span>
     <span class="mi">1102</span>  <span class="mi">052</span>       <span class="mi">1102</span>       <span class="mi">3</span>       <span class="mi">7</span>    <span class="mi">1</span>
     <span class="mi">1103</span>  <span class="mi">022</span>       <span class="mi">1103</span>       <span class="mi">4</span>       <span class="mi">8</span>    <span class="mi">0</span>
</pre></div>
</div>
<p>Output data view:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="n">fid</span>   <span class="n">sid</span> <span class="n">father</span> <span class="n">mother</span> <span class="n">sex</span> <span class="n">not_used</span>          <span class="n">snp</span>
<span class="mi">1100</span>  <span class="mi">1100</span>      <span class="mi">0</span>      <span class="mi">0</span>   <span class="mi">0</span>        <span class="mi">0</span>  <span class="n">A</span> <span class="n">A</span> <span class="n">B</span> <span class="n">B</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">1101</span>  <span class="mi">1101</span>      <span class="mi">0</span>      <span class="mi">0</span>   <span class="mi">0</span>        <span class="mi">0</span>  <span class="n">A</span> <span class="n">A</span> <span class="n">B</span> <span class="n">B</span> <span class="n">B</span> <span class="n">B</span>
<span class="mi">1102</span>  <span class="mi">1102</span>      <span class="mi">0</span>      <span class="mi">0</span>   <span class="mi">0</span>        <span class="mi">0</span>  <span class="n">A</span> <span class="n">A</span> <span class="mi">0</span> <span class="mi">0</span> <span class="n">B</span> <span class="n">B</span>
<span class="mi">1103</span>  <span class="mi">1103</span>      <span class="mi">0</span>      <span class="mi">0</span>   <span class="mi">0</span>        <span class="mi">0</span>  <span class="n">A</span> <span class="n">A</span> <span class="n">B</span> <span class="n">B</span> <span class="n">B</span> <span class="n">B</span>

 <span class="ow">or</span>

 <span class="n">fid</span>   <span class="n">sid</span> <span class="n">father</span> <span class="n">mother</span> <span class="n">sex</span> <span class="n">not_used</span>          <span class="n">snp</span>
<span class="mi">1100</span>  <span class="mi">1100</span>      <span class="mi">1</span>      <span class="mi">5</span>   <span class="mi">1</span>        <span class="mi">0</span>  <span class="n">A</span> <span class="n">A</span> <span class="n">B</span> <span class="n">B</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">1101</span>  <span class="mi">1101</span>      <span class="mi">2</span>      <span class="mi">6</span>   <span class="mi">2</span>        <span class="mi">0</span>  <span class="n">A</span> <span class="n">A</span> <span class="n">B</span> <span class="n">B</span> <span class="n">B</span> <span class="n">B</span>
<span class="mi">1102</span>  <span class="mi">1102</span>      <span class="mi">3</span>      <span class="mi">7</span>   <span class="mi">1</span>        <span class="mi">0</span>  <span class="n">A</span> <span class="n">A</span> <span class="mi">0</span> <span class="mi">0</span> <span class="n">B</span> <span class="n">B</span>
<span class="mi">1103</span>  <span class="mi">1103</span>      <span class="mi">4</span>      <span class="mi">8</span>   <span class="mi">0</span>        <span class="mi">0</span>  <span class="n">A</span> <span class="n">A</span> <span class="n">B</span> <span class="n">B</span> <span class="n">B</span> <span class="n">B</span>
</pre></div>
</div>
<p><strong>fam</strong> - <a class="reference external" href="https://www.cog-genomics.org/plink/1.9/formats#fam">https://www.cog-genomics.org/plink/1.9/formats#fam</a></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">snptools.format</span> <span class="kn">import</span> <span class="n">make_fam</span>

<span class="n">input_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;file.txt&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
<span class="n">data_fam</span> <span class="o">=</span> <span class="n">make_fam</span><span class="p">(</span><span class="n">input_data</span><span class="p">,</span> <span class="s2">&quot;SAMPLE_ID&quot;</span><span class="p">,</span> <span class="s2">&quot;SAMPLE_ID&quot;</span><span class="p">)</span>

<span class="ow">or</span>

<span class="n">make_fam</span><span class="p">(</span>
    <span class="n">input_data</span><span class="p">,</span>
    <span class="s2">&quot;SAMPLE_ID&quot;</span><span class="p">,</span>
    <span class="s2">&quot;FAMILY_ID&quot;</span><span class="p">,</span>
    <span class="n">father_col</span><span class="o">=</span><span class="s2">&quot;father&quot;</span><span class="p">,</span>
    <span class="n">mother_col</span><span class="o">=</span><span class="s2">&quot;mother&quot;</span><span class="p">,</span>
    <span class="n">sex_col</span><span class="o">=</span><span class="s2">&quot;sex&quot;</span><span class="p">,</span>
    <span class="n">pheno_col</span><span class="o">=</span><span class="s2">&quot;pheno&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Input data view:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SAMPLE_ID</span>  <span class="n">SNP</span>
     <span class="mi">1100</span>  <span class="mi">025</span>
     <span class="mi">1101</span>  <span class="mi">022</span>
     <span class="mi">1102</span>  <span class="mi">052</span>
     <span class="mi">1103</span>  <span class="mi">022</span>

 <span class="ow">or</span>

<span class="n">SAMPLE_ID</span>  <span class="n">SNP</span>  <span class="n">FAMILY_ID</span>  <span class="n">father</span>  <span class="n">mother</span>  <span class="n">sex</span>  <span class="n">pheno</span>
    <span class="mi">1100</span>  <span class="mi">025</span>       <span class="mi">1100</span>       <span class="mi">1</span>       <span class="mi">5</span>    <span class="mi">1</span>     <span class="mi">12</span>
    <span class="mi">1101</span>  <span class="mi">022</span>       <span class="mi">1101</span>       <span class="mi">2</span>       <span class="mi">6</span>    <span class="mi">2</span>     <span class="mi">13</span>
    <span class="mi">1102</span>  <span class="mi">052</span>       <span class="mi">1102</span>       <span class="mi">3</span>       <span class="mi">7</span>    <span class="mi">1</span>     <span class="mi">14</span>
    <span class="mi">1103</span>  <span class="mi">022</span>       <span class="mi">1103</span>       <span class="mi">4</span>       <span class="mi">8</span>    <span class="mi">0</span>     <span class="mi">15</span>
</pre></div>
</div>
<p>Output data view:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="n">fid</span>   <span class="n">sid</span> <span class="n">father</span> <span class="n">mother</span> <span class="n">sex</span> <span class="n">pheno</span>
<span class="mi">1100</span>  <span class="mi">1100</span>      <span class="mi">0</span>      <span class="mi">0</span>   <span class="mi">0</span>    <span class="o">-</span><span class="mi">9</span>
<span class="mi">1101</span>  <span class="mi">1101</span>      <span class="mi">0</span>      <span class="mi">0</span>   <span class="mi">0</span>    <span class="o">-</span><span class="mi">9</span>
<span class="mi">1102</span>  <span class="mi">1102</span>      <span class="mi">0</span>      <span class="mi">0</span>   <span class="mi">0</span>    <span class="o">-</span><span class="mi">9</span>
<span class="mi">1103</span>  <span class="mi">1103</span>      <span class="mi">0</span>      <span class="mi">0</span>   <span class="mi">0</span>    <span class="o">-</span><span class="mi">9</span>

<span class="ow">or</span>

 <span class="n">fid</span>   <span class="n">sid</span> <span class="n">father</span> <span class="n">mother</span> <span class="n">sex</span> <span class="n">pheno</span>
<span class="mi">1100</span>  <span class="mi">1100</span>      <span class="mi">1</span>      <span class="mi">5</span>   <span class="mi">1</span>    <span class="mi">12</span>
<span class="mi">1101</span>  <span class="mi">1101</span>      <span class="mi">2</span>      <span class="mi">6</span>   <span class="mi">2</span>    <span class="mi">13</span>
<span class="mi">1102</span>  <span class="mi">1102</span>      <span class="mi">3</span>      <span class="mi">7</span>   <span class="mi">1</span>    <span class="mi">14</span>
<span class="mi">1103</span>  <span class="mi">1103</span>      <span class="mi">4</span>      <span class="mi">8</span>   <span class="mi">0</span>    <span class="mi">15</span>
</pre></div>
</div>
<p><strong>lgen</strong> - <a class="reference external" href="https://www.cog-genomics.org/plink/1.9/formats#lgen">https://www.cog-genomics.org/plink/1.9/formats#lgen</a></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">snptools.format</span> <span class="kn">import</span> <span class="n">make_lgen</span>

<span class="n">input_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;file.txt&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
<span class="n">data_lgen</span> <span class="o">=</span> <span class="n">make_lgen</span><span class="p">(</span>
    <span class="n">input_data</span><span class="p">,</span> <span class="s2">&quot;Sample ID&quot;</span><span class="p">,</span> <span class="s2">&quot;SNP Name&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;Allele1 - AB&quot;</span><span class="p">,</span> <span class="s2">&quot;Allele2 - AB&quot;</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Input data view:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;SNP Name&quot;</span> <span class="s2">&quot;Sample ID&quot;</span> <span class="s2">&quot;Allele1 - AB&quot;</span> <span class="s2">&quot;Allele2 - AB&quot;</span> <span class="s2">&quot;GC Score&quot;</span> <span class="s2">&quot;GT Score&quot;</span>
             <span class="n">ABCA12</span> <span class="mi">107232207</span> <span class="n">A</span> <span class="n">A</span> <span class="mf">0.4048</span> <span class="mf">0.8164</span>
 <span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">13031</span> <span class="mi">107232207</span> <span class="n">B</span> <span class="n">B</span> <span class="mf">0.9083</span> <span class="mf">0.8712</span>
 <span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">13039</span> <span class="mi">107232207</span> <span class="n">A</span> <span class="n">A</span> <span class="mf">0.9005</span> <span class="mf">0.9096</span>
 <span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">13049</span> <span class="mi">107232207</span> <span class="n">A</span> <span class="n">B</span> <span class="mf">0.9295</span> <span class="mf">0.8926</span>
   <span class="o">...</span>
              <span class="n">ABCA12</span> <span class="mi">107237284</span> <span class="n">A</span> <span class="n">A</span> <span class="mf">0.4048</span> <span class="mf">0.8164</span>
  <span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">13031</span> <span class="mi">107237284</span> <span class="n">A</span> <span class="n">B</span> <span class="mf">0.9566</span> <span class="mf">0.9257</span>
  <span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">13039</span> <span class="mi">107237284</span> <span class="n">A</span> <span class="n">B</span> <span class="mf">0.3098</span> <span class="mf">0.8555</span>
  <span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">13049</span> <span class="mi">107237284</span> <span class="n">A</span> <span class="n">B</span> <span class="mf">0.8613</span> <span class="mf">0.8319</span>
   <span class="o">...</span>
</pre></div>
</div>
<p>Output data view:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fid</span>       <span class="n">sid</span>            <span class="n">snp_name</span> <span class="n">allele1</span> <span class="n">allele2</span>
 <span class="mi">1</span>  <span class="mi">107232207</span>              <span class="n">ABCA12</span>       <span class="n">A</span>       <span class="n">A</span>
 <span class="mi">1</span>  <span class="mi">107232207</span>  <span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">13031</span>       <span class="n">B</span>       <span class="n">B</span>
 <span class="mi">1</span>  <span class="mi">107232207</span>  <span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">13039</span>       <span class="n">A</span>       <span class="n">A</span>
 <span class="mi">1</span>  <span class="mi">107232207</span>  <span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">13049</span>       <span class="n">A</span>       <span class="n">B</span>
 <span class="mi">1</span>  <span class="mi">107232207</span>  <span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">13059</span>       <span class="n">A</span>       <span class="n">B</span>

 <span class="o">...</span>

 <span class="mi">1</span>  <span class="mi">107237284</span>              <span class="n">ABCA12</span>       <span class="n">A</span>       <span class="n">A</span>
 <span class="mi">1</span>  <span class="mi">107237284</span>  <span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">13031</span>       <span class="n">A</span>       <span class="n">B</span>
 <span class="mi">1</span>  <span class="mi">107237284</span>  <span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">13039</span>       <span class="n">A</span>       <span class="n">B</span>
 <span class="mi">1</span>  <span class="mi">107237284</span>  <span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">13049</span>       <span class="n">A</span>       <span class="n">B</span>
 <span class="mi">1</span>  <span class="mi">107237284</span>  <span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">13059</span>       <span class="n">A</span>       <span class="n">A</span>
 <span class="o">...</span>
</pre></div>
</div>
</section>
</section>
<section id="data-filtering">
<h2>Data filtering<a class="headerlink" href="#data-filtering" title="Link to this heading"></a></h2>
<p>Poor quality or uninformative SNPs can be excluded from the analysis. This
helps to reduce noise and improve the accuracy of the results.</p>
<section id="call-rate">
<h3>Call Rate<a class="headerlink" href="#call-rate" title="Link to this heading"></a></h3>
<p>The call rate for a given SNP is defined as the proportion of
individuals in the study for which the corresponding SNP information is
not missing. In the following example, we filter using a call rate of 95%,
meaning we retain SNPs for which there is less than 5% missing data.</p>
<p><strong>call rate marker</strong></p>
<p>Of the say, 54K markers in the chip, 50K have been genotyped for a
particular animal, the “call rate animal” is 50K/54K=93%</p>
<p>in_data:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="n">SNP_NAME</span> <span class="n">SAMPLE_ID</span> <span class="n">SNP</span>
            <span class="n">ABCA12</span> <span class="mi">1100</span> <span class="mi">0</span>
             <span class="n">APAF1</span> <span class="mi">1100</span> <span class="mi">2</span>
<span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">10172</span> <span class="mi">1100</span> <span class="mi">5</span>
            <span class="n">ABCA12</span> <span class="mi">1101</span> <span class="mi">0</span>
             <span class="n">APAF1</span> <span class="mi">1101</span> <span class="mi">2</span>
<span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">10172</span> <span class="mi">1101</span> <span class="mi">2</span>
            <span class="n">ABCA12</span> <span class="mi">1102</span> <span class="mi">0</span>
             <span class="n">APAF1</span> <span class="mi">1102</span> <span class="mi">5</span>
<span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">10172</span> <span class="mi">1102</span> <span class="mi">2</span>
            <span class="n">ABCA12</span> <span class="mi">1103</span> <span class="mi">0</span>
             <span class="n">APAF1</span> <span class="mi">1103</span> <span class="mi">2</span>
<span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">10172</span> <span class="mi">1103</span> <span class="mi">2</span>
            <span class="n">ABCA12</span> <span class="mi">1104</span> <span class="mi">5</span>
             <span class="n">APAF1</span> <span class="mi">1104</span> <span class="mi">1</span>
<span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">10172</span> <span class="mi">1104</span> <span class="mi">1</span>
            <span class="n">ABCA12</span> <span class="mi">1105</span> <span class="mi">0</span>
             <span class="n">APAF1</span> <span class="mi">1105</span> <span class="mi">2</span>
<span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">10172</span> <span class="mi">1105</span> <span class="mi">5</span>
            <span class="n">ABCA12</span> <span class="mi">1106</span> <span class="mi">0</span>
             <span class="n">APAF1</span> <span class="mi">1106</span> <span class="mi">1</span>
<span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">10172</span> <span class="mi">1106</span> <span class="mi">2</span>
            <span class="n">ABCA12</span> <span class="mi">1107</span> <span class="mi">5</span>
             <span class="n">APAF1</span> <span class="mi">1107</span> <span class="mi">2</span>
<span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">10172</span> <span class="mi">1107</span> <span class="mi">1</span>
            <span class="n">ABCA12</span> <span class="mi">1108</span> <span class="mi">0</span>
             <span class="n">APAF1</span> <span class="mi">1108</span> <span class="mi">2</span>
<span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">10172</span> <span class="mi">1108</span> <span class="mi">2</span>
            <span class="n">ABCA12</span> <span class="mi">1109</span> <span class="mi">0</span>
             <span class="n">APAF1</span> <span class="mi">1109</span> <span class="mi">2</span>
<span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">10172</span> <span class="mi">1109</span> <span class="mi">2</span>
            <span class="n">ABCA12</span> <span class="mi">1110</span> <span class="mi">5</span>
             <span class="n">APAF1</span> <span class="mi">1110</span> <span class="mi">2</span>
<span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">10172</span> <span class="mi">1110</span> <span class="mi">2</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">snptools.statistics</span> <span class="kn">import</span> <span class="n">call_rate</span>

<span class="n">input_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;file.txt&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">call_rate</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">input_data</span><span class="p">,</span> <span class="n">id_col</span><span class="o">=</span><span class="s2">&quot;SNP_NAME&quot;</span><span class="p">,</span> <span class="n">snp_col</span><span class="o">=</span><span class="s2">&quot;SNP&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>result:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>          <span class="n">SNP_NAME</span>       <span class="n">SNP</span>
            <span class="n">ABCA12</span>  <span class="mf">0.727273</span>
             <span class="n">APAF1</span>  <span class="mf">0.909091</span>
<span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">10172</span>  <span class="mf">0.818182</span>
</pre></div>
</div>
<p><strong>call rate animal</strong></p>
<p>Of the say, 900 animals genotyped for marker CL635944_160.1, how many
have actually been successfully read? Assume that 600 have been read, then
the “call rate marker” is 600/900 = 67%</p>
<p>in_data:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>          <span class="n">SNP_NAME</span> <span class="n">SAMPLE_ID</span> <span class="n">SNP</span>
            <span class="n">ABCA12</span>     <span class="mi">14814</span>   <span class="mi">0</span>
<span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">13031</span>     <span class="mi">14814</span>   <span class="mi">2</span>
<span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">13039</span>     <span class="mi">14814</span>   <span class="mi">0</span>
<span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">13049</span>     <span class="mi">14814</span>   <span class="mi">1</span>
<span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">13059</span>     <span class="mi">14814</span>   <span class="mi">1</span>
<span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">13086</span>     <span class="mi">14814</span>   <span class="mi">0</span>
<span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">13093</span>     <span class="mi">14814</span>   <span class="mi">1</span>
<span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">13110</span>     <span class="mi">14814</span>   <span class="mi">5</span>
<span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">13111</span>     <span class="mi">14814</span>   <span class="mi">0</span>
<span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">13113</span>     <span class="mi">14814</span>   <span class="mi">1</span>
<span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">15633</span>     <span class="mi">14814</span>   <span class="mi">0</span>
<span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">15634</span>     <span class="mi">14814</span>   <span class="mi">0</span>
<span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">15637</span>     <span class="mi">14814</span>   <span class="mi">0</span>
<span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">15659</span>     <span class="mi">14814</span>   <span class="mi">0</span>
<span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">15668</span>     <span class="mi">14814</span>   <span class="mi">5</span>
<span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">15708</span>     <span class="mi">14814</span>   <span class="mi">0</span>
<span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">15718</span>     <span class="mi">14814</span>   <span class="mi">0</span>
            <span class="n">ABCA12</span>     <span class="mi">14815</span>   <span class="mi">0</span>
<span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">13031</span>     <span class="mi">14815</span>   <span class="mi">1</span>
<span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">13039</span>     <span class="mi">14815</span>   <span class="mi">1</span>
<span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">13049</span>     <span class="mi">14815</span>   <span class="mi">1</span>
<span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">13059</span>     <span class="mi">14815</span>   <span class="mi">0</span>
<span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">13086</span>     <span class="mi">14815</span>   <span class="mi">1</span>
<span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">13093</span>     <span class="mi">14815</span>   <span class="mi">5</span>
<span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">13110</span>     <span class="mi">14815</span>   <span class="mi">2</span>
<span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">13111</span>     <span class="mi">14815</span>   <span class="mi">1</span>
<span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">13113</span>     <span class="mi">14815</span>   <span class="mi">2</span>
<span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">15633</span>     <span class="mi">14815</span>   <span class="mi">0</span>
<span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">15634</span>     <span class="mi">14815</span>   <span class="mi">2</span>
<span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">15637</span>     <span class="mi">14815</span>   <span class="mi">2</span>
<span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">15659</span>     <span class="mi">14815</span>   <span class="mi">2</span>
<span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">15668</span>     <span class="mi">14815</span>   <span class="mi">5</span>
<span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">15708</span>     <span class="mi">14815</span>   <span class="mi">1</span>
<span class="n">ARS</span><span class="o">-</span><span class="n">BFGL</span><span class="o">-</span><span class="n">BAC</span><span class="o">-</span><span class="mi">15718</span>     <span class="mi">14815</span>   <span class="mi">2</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">snptools.statistics</span> <span class="kn">import</span> <span class="n">call_rate</span>

<span class="n">input_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;file.txt&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">call_rate</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data_df</span><span class="p">,</span> <span class="n">id_col</span><span class="o">=</span><span class="s2">&quot;SAMPLE_ID&quot;</span><span class="p">,</span> <span class="n">snp_col</span><span class="o">=</span><span class="s2">&quot;SNP&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>result:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SAMPLE_ID</span>       <span class="n">SNP</span>
    <span class="mi">14814</span>  <span class="mf">0.882353</span>
    <span class="mi">14815</span>  <span class="mf">0.882353</span>
</pre></div>
</div>
</section>
<section id="frequence-allele">
<h3>Frequence Allele<a class="headerlink" href="#frequence-allele" title="Link to this heading"></a></h3>
<p>The allele frequency represents the incidence of a gene variant in a
population.</p>
<p>The minor allele frequency is therefore the frequency at which the
minor allele occurs within a population.</p>
</section>
<section id="hwe-hardy-weinberg-equilibrium">
<h3>HWE (Hardy-Weinberg equilibrium)<a class="headerlink" href="#hwe-hardy-weinberg-equilibrium" title="Link to this heading"></a></h3>
<p>The Hardy-Weinberg equilibrium is a principle stating that the genetic
variation in a population will remain constant from one generation to the
next in the absence of disturbing factors.
<a class="reference external" href="https://www.nature.com/scitable/definition/hardy-weinberg-equilibrium-122/">https://www.nature.com/scitable/definition/hardy-weinberg-equilibrium-122/</a></p>
<p>Once the data have been prepared, statistical analysis to identify associations,
patterns, or relationships between SNPs and the phenotypes or diseases of
interest (GWAS). phenotypes or diseases of interest (GWAS).</p>
</section>
</section>
<section id="parentage">
<h2>Parentage<a class="headerlink" href="#parentage" title="Link to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="description.html" class="btn btn-neutral float-left" title="Introduction" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="modules.html" class="btn btn-neutral float-right" title="snptools" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Igor Locshinin.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>